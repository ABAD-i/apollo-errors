{"version":3,"sources":["../src/index.js"],"names":["errorMap","Map","DELIMITER","serializeName","arr","reduce","str","val","length","toString","deserializeName","name","split","ApolloError","message","time_thrown","Date","toISOString","data","options","t","arguments","thrown_at","d","Object","assign","opts","JSON","stringify","_name","_humanized_message","_time_thrown","_data","_locations","showLocations","locations","_path","showPath","path","error","createError","e","bind","set","formatError","originalError","returnNull","undefined","parse","CustomError","get","serialize"],"mappings":"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","file":"index.js","sourcesContent":["import ExtendableError from 'es6-error';\n\nconst errorMap = new Map();\n\nconst DELIMITER = '/::/';\n\nconst serializeName = (arr = []) => arr.reduce((str, val) => `${str.length > 0 ? str + DELIMITER : str}${val.toString ? val.toString() : val}`, '');\nconst deserializeName = (name = '') => name.split(DELIMITER);\n\nclass ApolloError extends ExtendableError {\n  constructor (name, {\n    message,\n    time_thrown = (new Date()).toISOString(),\n    data = {},\n    options = {},\n  }) {\n    const t = (arguments[2] && arguments[2].thrown_at) || time_thrown;\n    const d = Object.assign({}, data, ((arguments[2] && arguments[2].data) || {}));\n    const opts = Object.assign({}, options, ((arguments[2] && arguments[2].options) || {}));\n\n    super(serializeName([\n      name,\n      t,\n      Object.assign({}, d, {\n        toString: () => JSON.stringify(d)\n      }),\n    ]));\n\n    this._name = name;\n    this._humanized_message = message || '';\n    this._time_thrown = t;\n    this._data = d;\n    this._locations = (opts.showLocations && arguments[2] && arguments[2].locations)\n    this._path = (opts.showPath && arguments[2] && arguments[2].path);\n  }\n  serialize () {\n    const name = this._name;\n    const message = this._humanized_message;\n    const time_thrown = this._time_thrown;\n    const data = this._data;\n    const locations = this._locations;\n    const path = this._path;\n    let error = {\n      message,\n      name,\n      time_thrown,\n      data,\n    };\n    if (locations) error.locations = locations;\n    if (path) error.path = path;\n    return error;\n  }\n}\n\nexport const createError = (name, data = { message: 'An error has occurred', options }) => {\n  const e = ApolloError.bind(null, name, data);\n  errorMap.set(name, e);\n  return e;\n};\n\nexport const formatError = (originalError, returnNull = false) => {\n  const [ name, thrown_at, d ] = deserializeName(originalError.message);\n  const { locations, path } = originalError;\n  const data = d !== undefined ? JSON.parse(d) : {};\n  if (!name) return returnNull ? null : originalError;\n  const CustomError = errorMap.get(name);\n  if (!CustomError) return returnNull ? null : originalError;\n  const error = new CustomError({\n    thrown_at,\n    data,\n    locations,\n    path,\n  });\n  return error.serialize();\n};\n"]}